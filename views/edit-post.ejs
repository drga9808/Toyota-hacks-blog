<%- include('partials/header.ejs') %>

    <section class="container pb-5">
        <div class="post-edit">
            <h1>Edit Post</h1>

            <!-- MAIN FORM: Edit + Save Changes -->
            <form action="/post/<%= slug %>" method="POST">
                <!-- Post Title -->
                <div class="placeholders">
                    <label>Title:</label>
                    <input type="text" name="title" value="<%= post.title %>" required class="form-control">
                </div>

                <!-- Post Date -->
                <div class="placeholders">
                    <label>Date:</label>
                    <input type="text" name="date" value="<%= post.date %>" class="form-control">
                </div>

                <!-- Category -->
                <div class="placeholders">
                    <label>Category:</label>
                    <select name="category" class="form-control" required>
                        <option value="Parts" <%=post.category==='Parts' ? 'selected' : '' %>>Parts</option>
                        <option value="Repairs" <%=post.category==='Repairs' ? 'selected' : '' %>>Repairs</option>
                        <option value="Common Issues" <%=post.category==='Common Issues' ? 'selected' : '' %>>Common
                            Issues</option>
                    </select>
                </div>

                <!-- Read Time -->
                <div class="placeholders">
                    <label>Read Time:</label>
                    <input type="text" name="readTime" value="<%= post.readTime %>" class="form-control">
                </div>

                <!-- Image -->
                <div class="row align-items-start mb-5">
                    <div class="col-md-6">
                        <label class="mb-2" for="image">Image URL:</label>
                        <input type="text" id="image" name="image" value="<%= post.image %>" class="form-control mb-4">
                    </div>
                    <div class="col-md-6">
                        <label class="d-block mb-2">Preview:</label>
                        <img src="<%= post.image %>" alt="Post Image" class="img-fluid border rounded shadow-sm"
                            style="max-height: 200px;">
                    </div>
                </div>

                <!-- Description -->
                <div class="placeholders">
                    <label>Description:</label>
                    <textarea name="description" class="form-control"><%= post.description %></textarea>
                </div>

                <!-- Content -->
                <div class="placeholders">
                    <label>Content (HTML allowed):</label>
                    <textarea name="content" class="form-control mb-3" rows="10"><%= post.content %></textarea>
                </div>

                <!-- Save Changes Button -->
                <div class="text-center mt-3 pb-2">
                    <button type="submit" class="btn btn-success px-4">üíæ Save Changes</button>
                </div>
            </form>

            <!-- Delete Post Button (separate form) -->
            <div class="text-center mt-3">
                <button type="button" class="btn btn-danger" data-bs-toggle="modal"
                    data-bs-target="#confirmDeleteModal">
                    üóëÔ∏è Delete Post
                </button>
            </div>

            <!-- Pop-up window for confirmation of delete -->
            <div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-labelledby="confirmDeleteModalLabel"
                aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="confirmDeleteModalLabel">Confirm Deletion</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            Are you sure you want to delete this post? This action cannot be undone.
                        </div>
                        <div class="modal-footer">
                            <form action="/edit-post/delete-post/<%= slug %>" method="POST">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                <button type="submit" class="btn btn-danger">Yes, Delete</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Back Link -->
            <div class="back-link-wrapper mt-4">
                <a class="back-link" href="/">‚Üê Back to home</a>
            </div>
        </div>
    </section>

    <%- include('partials/footer.ejs') %>